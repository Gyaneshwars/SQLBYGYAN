Use pathfinder
--ETL,AZURE DATA FACTORY AND POWER BI DEVELOPER --> GNANESHWAR SRAVANE

IF OBJECT_ID('TEMPDB..#KEYPEIN') IS NOT NULL DROP TABLE #KEYPEIN  CREATE TABLE #KEYPEIN (KEYPERSON int,SPGMIEIN int,LOGINNAME VARCHAR(70)); INSERT INTO #KEYPEIN VALUES  
(2546055,810844566,'abhishek_khawale'),(2648839,810845308,'abhishek_tiwari2'),(750562,710815745,'mabuashwad'),(2374568,810842584,'adarsh_jaiswal'),(1882160,810838793,'aditi_sharma'),(752581,710834894,'safrin'),(2655816,810845459,'agresh_agrawal'),(777660,810823440,'athavva'),(2467299,810843902,'aishwarya_drablani'),(2648827,810845264,'a_chevula'),(1268322,810831946,'aishwarya_pandit'),(1900500,810839118,'akshita_kedawat'),(2379717,810842856,'aman_kumar_patidar'),(2648830,810845296,'amit_brijawasi'),(751294,710823811,'auppuluri'),(750792,710818702,'yanantababu'),(752042,710830729,'asistla'),(752053,710830750,'asatti'),(752109,710831346,'avadapalli'),(2379645,810842667,'a_saxena'),(2648836,810845305,'aparna_paliwal'),(1077018,810829125,'apeksha_agarwal'),(1103940,810829711,'archana_somarapu'),(754771,810812002,'arokkam'),(751105,710822013,'aneella'),(753336,710841200,'aaddagalla'),(754992,810812870,'a_atakamwar'),(750591,710816243,'achinthoti'),(2655804,810845434,'ayasha_gulgulia'),(2379711,810842820,'ayush_joshi1'),(2733919,810845995,'ayushi_patel'),(2648824,810845261,'ayushi_rathore'),(2648844,810845314,'shivaprasad_rao_b'),(750638,710816636,'bkothaluru'),(750904,710819839,'bbadisa'),(752058,710830759,'bshivannagari'),(751893,710829841,'bboya'),(2374461,710819857,'b_komala'),(2546054,810844562,'bhawna_meghani'),(752572,710834884,'vboyapati'),(1533274,810827955,'brij_ruparel'),(755425,810814972,'cmisoorappagari'),(1591786,810837097,'c_nainolla'),(751989,710830360,'cvadla'),(751232,710822994,'vchaudarapu'),(751082,710821676,'cmalasani'),(2467286,810843846,'chirag_chudasama'),(751235,710822997,'cmungamuri'),(751938,710830050,'hchitra'),(2546050,810844552,'chitra_tare'),(751231,710822992,'gdamera'),(2467283,810843834,'d_patel2'),(298665,510298665,'dasharaths'),(2648840,810845310,'deep_shikha_kumari'),(2698341,810845661,'devanshi_bhatt'),(2698376,810845714,'dhairya_mandowra'),(2648834,810845301,'dharani_pabboju'),(2655811,810845447,'dheeraj_a_v'),(1005826187,810825710,'dhruv_mehta'),(1900509,810839137,'disha_upmanyu'),(1322479,810833106,'drashti_jani'),(1019588,810827955,'ebin_eldhose'),(750697,710817406,'emohammad'),(754165,710845701,'etangudu'),(2057081,810841073,'fahad_sheikh'),(753258,710840701,'gbrundavanam'),(2022748,810840590,'gaurang_mrug'),(2648855,810845408,'geetha_devi_g'),(752577,710834890,'gmahmood'),(752569,710834878,'gsravane'),(762588,810821418,'GOONJALD'),(2655803,810845430,'gourav_sahoo'),(2698396,810845773,'govind_maheshwari'),(752436,710834043,'hmupparaju'),(751897,710829846,'hjaldu'),(762589,810821420,'HARDIKVP'),(752893,710838112,'hbattili'),(752517,710834513,'hbommasetty'),(762590,810821419,'HARSHILHB'),(2698378,810845717,'hem_shah'),(752437,710834044,'hchinta'),(2467278,810843813,'m_maddirala'),(2655814,810845456,'hiren_brahmbhatt'),(2374560,810842567,'honey_makrani'),(2343506,810841995,'isha_aggarwal'),(2648850,810845336,'isha_chana'),(1882166,810838802,'isha_pandya'),(750914,710819856,'jbalasubramanyam'),(2655805,810845435,'janak_raj_upadhyay'),(752055,710830754,'jparikapalli'),(751506,710825998,'jaligi'),(2648860,810845414,'jay_majhi'),(2648859,810845413,'jesica_jain'),(1005917308,810826503,'jhanvi_ruparel'),(752046,710830738,'jvelicheti'),(750294,710810985,'skadalamkodi'),(750404,710813736,'skakarparty'),(755113,810813326,'kmohammad'),(751943,710830057,'kpolisetty'),(752518,710834514,'kpativada'),(750588,710816237,'jkanmuri'),(752801,710836596,'kyanamadala'),(2698406,810845788,'kashish_khan'),(2057089,810841117,'kaushal_chauhan'),(1240811,810831627,'kavya_marsetti'),(751857,710829581,'mkintali'),(751971,710830326,'kkudumula'),(750589,710816238,'kvidiyala'),(1900504,810839124,'kirti_parihar'),(750719,710817878,'krenuvardhan'),(755294,810814309,'kryali'),(750807,710818750,'kareti'),(2709554,810845790,'krutik_sanghvi'),(751511,710826009,'kpaidi'),(750405,710813738,'skummari'),(752566,710834873,'lyedlapalli'),(1005913743,810826450,'lalit_pawar'),(755698,810816152,'lchichili'),(2648843,810845313,'latika_pardeshi'),(752626,710835217,'lthammalithota'),(751295,710823812,'lboorla'),(751992,710830365,'lmote'),(751350,710824425,'mninnekar'),(750255,710810416,'rmadduri'),(753192,710840250,'mmysa'),(752625,710835216,'madhuri_a'),(751298,710823818,'muppalapati'),(750417,710813778,'mnarra'),(1882168,810838809,'mangalam_parwal'),(750449,710814092,'mkadimisetti'),(751945,710830063,'mkalupukuri'),(2648829,810845295,'manoj_kumar_b'),(1882155,810838788,'manu_saini'),(750660,710817067,'amatukumilli'),(1282239,810832241,'maunil_sheth'),(756804,510756804,'mehulc'),(2655809,810845439,'merlin_varghese'),(2648838,810845307,'mitali_singh'),(750296,710810989,'jmohammad'),(750554,710815713,'amohammed'),(1978809,810840137,'mohit_dhandhariya'),(751300,710823823,'mavusula'),(751990,710830361,'mtiriveedhi'),(1077027,810829170,'c_mounika'),(750674,710817098,'jmudadla'),(750924,710819885,'mkuppireddy'),(1882163,810838798,'muskan_sen'),(754670,810811386,'ngoli'),(751509,710826002,'nsarvasiddi'),(751236,710822998,'nnirukonda'),(750409,710813742,'snagandla'),(753127,710839847,'nbachamgari'),(751982,710830351,'nsomisetty'),(750870,710819342,'npilligundla'),(1944807,810839642,'nandinie_dubey'),(752578,710834891,'npinnapureddy'),(751065,710821425,'nkotha'),(754761,810811981,'nponnada'),(750258,710810424,'cnarreddula'),(750632,710816618,'dnatwa'),(1316938,810832673,'navitha_kandadi'),(1571828,810836853,'nayanshree_shinde'),(754087,710845388,'npanda'),(773092,810818827,'ndorsula'),(2648831,810845297,'nikhitha_jaiswal'),(2546058,810844577,'nikita_pal'),(2057122,810841322,'niranjan_kothari'),(2379652,810842681,'nishil_hemnani'),(2648835,810845302,'nitish_dobriyal'),(763273,810821502,'nislam'),(2698332,810845652,'om_bakraniya'),(1548048,810836425,'pallavi_agrawal'),(2022773,810840715,'parag_gupta'),(750763,710818250,'vparasa'),(2655812,810845450,'pavan_kumar_basava'),(2467302,810843918,'payal_kotwani'),(750694,710817401,'npeddakotla'),(752041,710830728,'spenmetsa'),(1230395,810831496,'piyush_raychura'),(693271,510693271,'poojaj'),(752020,710830545,'pdara'),(750765,710818252,'pragula'),(2698334,810845654,'prachi_jain2'),(1900506,810839126,'prachi_yadav'),(751172,710822499,'prondla'),(754671,810811387,'pvupputuri'),(2379642,810842664,'p_paliwal'),(754915,810812497,'pramita_gedam'),(1131667,810829990,'p_pasuparthy'),(765020,810821559,'prasannb'),(2648833,810845300,'prasthi_samani'),(2409632,810843222,'pratik_baid'),(2648845,810845315,'pravallika_kadari'),(751917,710829894,'paitha'),(2467295,810843889,'praveen_gavhade_p'),(750381,710813358,'pracharla'),(1882165,810838801,'priya_mantri'),(1927885,810839198,'priyansh_jain1'),(2546049,810844551,'priyanshu_rathore'),(753522,710842493,'pguin'),(2648832,810845298,'rahul_mondal'),(2648825,810845262,'raja_epari'),(755351,810814624,'rkudumula'),(751937,710830049,'rbhajanthri'),(750407,710813740,'rpittala'),(752045,710830736,'ryekkaluru'),(1005794439,810825224,'ram_agrawal'),(750909,710819845,'rsurla'),(753820,710844178,'rsheela'),(751858,710829584,'rkurakula'),(752515,710834511,'aramadevi'),(754787,810812024,'nramadevi'),(780023,810823492,'sramamani'),(753480,710842233,'rdora'),(751898,710829848,'rjajam'),(751936,710830048,'rnutheti'),(751970,710830325,'rkolli'),(750615,710816328,'rgajula'),(750794,710818704,'rthoti'),(753552,710842698,'rvadada'),(752942,710838920,'rboddu'),(751894,710829842,'rpodendla'),(752561,710834868,'rkolan'),(751291,710823807,'rbarad'),(2696484,810845366,'r_harishwar_reddy'),(1882156,810838789,'rashi_agrawal'),(750915,710819860,'rkaturi'),(752564,710834871,'rponaganti'),(750616,710816329,'bravipati'),(2546059,810844578,'ritesh_maheshwari2'),(2698322,810845629,'riya_singh2'),(2655813,810845454,'rohit_jain5'),(1900505,810839125,'ronak_maheshwari'),(2343401,810841842,'ronak_puri'),(1183251,810830718,'roshni_panchal'),(2379662,810842693,'rushali_singh'),(1071018,810829290,'ruta_shah'),(2648842,810845312,'sachin_pawar'),(2655810,810845442,'sagnik_gupta'),(756487,810819450,'sbrundavanam'),(2648826,810845263,'sai_divya_balivada'),(1005913747,810826462,'sakshi_periwal'),(2648852,810845379,'sakshi_uradi'),(750720,710817879,'asala'),(2698383,810845743,'samarpita_dhar'),(751299,710823820,'snutalapati'),(2379693,810842765,'samruddhi_shrimali'),(756225,810818529,'sbollu'),(2546065,810844592,'saniya_neema'),(751296,710823813,'sbotthamolla'),(750721,710817881,'smethuku'),(752019,710830544,'smedapati'),(750544,710815382,'ssantosh'),(755352,810814625,'ssamudrala'),(752570,710834881,'snemali'),(754166,710845703,'saritam'),(757734,810820502,'rgarlapati'),(754892,810812406,'snandeekam'),(755346,810814601,'siyili'),(750727,710817893,'smadala'),(2655802,810845429,'selvin_sunny'),(2655807,810845437,'shaheena_p'),(750656,710817060,'nshaik'),(754058,710845330,'shalini_bhardwaj'),(751896,710829845,'spalakuri'),(2546063,810844585,'shikhar_sengar'),(751452,710825482,'sganji'),(2374587,810842641,'s_agrawal2'),(2343507,810841996,'shivangi_agrawal'),(2648841,810845311,'shivani_vaishnav'),(2374570,810842589,'shivika_bhatnagar'),(2791934,810845776,'shobhit_jain'),(2655799,810845304,'shraddha_agrawal'),(2546075,810844680,'shraddha_rathore'),(2698316,810845619,'shubh_verma'),(2379647,810842669,'s_gangrade'),(1900507,810839127,'shubhashish_vaidya'),(1189225,810830674,'s_beerelli'),(752944,710838923,'sjada'),(756105,810818079,'svankineni'),(762317,810821224,'clanka'),(751905,710829868,'asiva'),(753126,710839846,'sivajyothi_cherukuri'),(750795,710818705,'ssomisetty'),(2057085,810841099,'sonali_mohanty'),(754562,810810711,'sbalagiri'),(2698386,810845748,'sonia_sharma3'),(752514,710834510,'spaspunuri'),(1591793,810837135,'soumya_raparthi'),(2379706,810842810,'soumya_yadav'),(751494,710825966,'sravanthi_merugu'),(2648857,810845411,'sri_hari_ayinampudi'),(751967,710830320,'schava'),(752627,710835218,'smuppalla'),(752111,710831349,'spullai'),(754669,810811385,'skommu'),(751984,710830353,'sbollam'),(750154,710808683,'psrinivas'),(750673,710817097,'spolepally'),(752108,710831345,'sthodupunuri'),(751017,710820964,'spogula'),(2698369,810845699,'srishti_malviya'),(2648837,810845306,'steffy_biju'),(2374558,810842563,'stuti_yadav'),(752599,710834927,'sgopireddi'),(756227,810818531,'sboosetty'),(759761,810820623,'sarla'),(751859,710829585,'nsuman'),(755816,810816626,'sgudumuru'),(780026,810823496,'ssunetra'),(755335,810814490,'sdaggupati'),(751512,710826011,'smallareddi'),(752576,710834889,'sbuddhi'),(751986,710830355,'sboya'),(751503,710825995,'svaskuri'),(755123,810813353,'sbandaroo'),(1571827,810836852,'sweta_shukla'),(754571,810810725,'smada'),(1548047,810836424,'tanay_dusad'),(1882161,810838795,'tanya_agrawal'),(2409634,810843234,'tarun_soni2'),(762591,810821448,'TARUNS'),(750590,710816242,'sthallapalli'),(750908,710819844,'vthota'),(753684,710843592,'tvanka'),(754821,810812102,'tanasi'),(753344,710841220,'uboddu'),(754786,810812023,'ukurva'),(751941,710830054,'uchekka'),(751902,710829861,'uvaddadi'),(752943,710838922,'vkukunuri'),(751233,710822995,'lvadakattu'),(2655806,810845436,'vaishali_saraswat'),(777661,810823494,'vboga'),(1198781,810831028,'vaishnavi_narla'),(750911,710819850,'vvallabhapuram'),(750913,710819855,'vboreddigari'),(752054,710830752,'vvani'),(2379646,810842668,'vanshika_lattoo'),(757027,510757027,'veenac'),(757730,810820512,'vdonthikurthi'),(750670,710817093,'vboddu'),(755296,810814313,'vvadlani'),(752018,710830543,'vvaddineedi'),(752565,710834872,'vmuthyam'),(751234,710822996,'vgolagani'),(756500,810819545,'vpeethala'),(751895,710829843,'vgadhamsetty'),(752171,710831719,'vbaktula'),(750935,710819909,'vraghavapurapu'),(750871,710819343,'vgalepelli'),(751412,710825015,'vvatti'),(751907,710829870,'vmukku'),(752017,710830537,'vvadlakonda'),(751348,710824421,'vkatta'),(753136,710839863,'vdaram'),(754661,810811369,'vtulluru'),(755300,810814321,'vgalam'),(751293,710823810,'nvenu'),(2655815,810845457,'vijay_kethavath'),(751916,710829893,'vburugu'),(2546066,810844598,'v_tiwari'),(2696486,810845473,'vinay_chandnani'),(2655808,810845438,'vishal_sarakar'),(752044,710830735,'vshivvannolla'),(2546056,810844568,'vishva_rana'),(750510,710814762,'pvoona'),(750450,710814093,'ryamala'),(750826,710819243,'ykonduri')


IF OBJECT_ID ('TEMPDB..#RRR') IS NOT NULL DROP TABLE #RRR
Select CONVERT(DATE,ti.TASKINSTANCECOMPLETED) AS Enddate, p.keyperson,P1.SPGMIEIN, p.LoginName,ips.KeyProcessStream,ips.StreamName, 
ipi.ProcessInstanceAppianID ,ti.TaskInstanceBegun,ti.TaskInstanceCompleted,ti.TaskInstanceEffort,ti.ExpectedTaskEffort,ipi.ProcessWorkUnits,
SNLANALYSTTASKENTRY,ipi.ProcessInstanceInstantiated+'05:30' as insertdate,taskname,
case  ips.keyprocessstream 

-- when 45587 then   '0.5'     when 47029 then   '0.5'    when 22099 then   '0.5'   when 22050 then   '0.5'   when 45588 then   '0.75'  when 22287 then   '0.75'   when 22323 then   '0.75'   when 47000 then   '0.75'  
-- when 47106 then   '0.75'   when 22351 then   '0.75'  when 31283 then   '0.75'  when 44429 then   '0.75'  when 22284 then   '0.75'  when 23146 then   '1.15'   when 22425 then   '1.25'  
-- when 25873 then   '1.25'   when 22336 then   '1.25'  when 23467 then   '1.25'  when 47133 then   '1.25'  when 45778 then   '1.25'  when 22240 then   '1.25'   when 44422 then   '1.25'   when 22301 then   '1.25'  
-- when 22309 then   '1.25'   when 22237 then   '1.25'  when 47001 then   '1.25'  when 22098 then   '1.25'  when 45585 then   '1.25'  when 22290 then   '1.25'   when 25757 then   '1.25'  
-- when 22188 then   '1.25'   when 22244 then   '1.25'  when 25800 then   '1.25'  when 22089 then   '1.25'  when 44423 then   '1.25'  when 22427 then   '1.25'   when 22307 then   '1.5'    when 22192 then   '1.5'  
-- when 22288 then   '1.5'    when 22020 then   '1.5'   when 22286 then   '1.5'   when 22020 then   '1.5'   when 22020 then   '1.5'   when 22020 then   '1.5'    when 22020 then   '1.5'    when 22020 then   '1.5'  
-- when 22020 then   '1.5'    when 22020 then   '1.5'   when 22020 then   '1.5'   when 22020 then   '1.5'   when 22020 then   '1.5'   when 22020 then   '1.5'    when 22419 then   '1.5'    when 22418 then   '1.5'  
-- when 22227 then   '1.5'    when 22182 then   '1.5'   when 22289 then   '1.5'   when 23911 then   '1.5'   when 23911 then   '1.5'   when 22281 then   '1.5'    when 22280 then   '1.5'    when 47347 then   '1.5'  
-- when 46731 then   '1.75'   when 22190 then   '1.75'  when 22424 then   '2'     when 22216 then   '2'     when 22420 then   '2'     when 26085 then   '2.5'    when 47323 then   '2'      when 51907 then   '1.5' 
-- when 22422 then   '2'      when 55278 then  '0.6' 
 
 --Mallesh DQ Team

when  45587 then '2.5' when  47106 then '3.75'  when  25873 then '6.25'  when  22309 then '6.25'  when  22188 then '6.25'  when  22288 then '7.5'  when  22020 then '7.5'  when  46731 then '8.75'
when  47029 then '2.5'  when  22351 then '3.75'  when  22336 then '6.25'  when  22237 then '6.25'  when  22244 then '6.25'  when  22020 then '7.5'  when  22020 then '7.5'  when  22182 then '7.5' 
 when  22190 then '8.75'  when  55278 then '3'  when  22099 then '2.5'  when  31283 then '3.75'  when  23467 then '6.25'    when  22020 then '7.5'
when  22289 then '7.5'  when  22424 then '10'  when  22050 then '2.5'  when  44429 then '3.75'  when  47133 then '6.25'  when  22098 then '6.25'  when  22089 then '6.25'  when  22020 then '7.5'  when  22020 then '7.5'
when  23911 then '7.5'  when  22216 then '10'  when  45588 then '3.75'  when  22284 then '3.75'   when  45585 then '6.25'  when  44423 then '6.25'  when  22020 then '7.5'  when  22020 then '7.5' 
 when  23911 then '7.5'  when  22287 then '3.75'  when  23146 then '5.75'  when  22240 then '6.25'  when  22290 then '6.25'  when  22427 then '6.25'  when  22020 then '7.5' when  22020 then '7.5'
when  22281 then '7.5'  when  26085 then '12.5' when  22323 then '3.75'  when  22425 then '6.25'  when  44422 then '6.25'  when  25757 then '6.25'  when  22307 then '7.5'  when  22020 then '7.5'  when  22280 then '7.5'
when  47323 then '10'  when  47000 then '3.75'  when  22301 then '6.25'  when  22192 then '7.5'  when  22020 then '7.5'  when  47347 then '7.5'  when  51907 then '7.5'  when  49174 then '5'  when  21898 then '5'
when  53175 then '5'  when  25801 then '5'  when  22342 then '5'  when  53169 then '5'  when  53174 then '5'  when  22304 then '5'  when  27228 then '5'  when  53173 then '5'  when  48131 then '5'  when  27171 then '5' 
 when  53144 then '5'  when  22357 then '5'  when  53127 then '5'  when  47031 then '5'  when  22350 then '5'  when  22333 then '5'  when  22359 then '5'  when  22320 then '5'  when  22361 then '5'  when  22091 then '5'
when  24605 then '5'  when  47105 then '5'  when  53170 then '5'  when  47032 then '5'  when  47044 then '5'  when  22222 then '5'  when  47027 then '5'  when  23247 then '5'  when  22335 then '5'  when  44432 then '5'
when  22215 then '5'  when  22278 then '5'  when  47017 then '5'  when  44421 then '5'  when  22363 then '5'  when  22353 then '5'  when  50874 then '5'  when  22245 then '5'  when  22094 then '5'  when  53595 then '5'
when  22339 then '5'  when  53597 then '5'  when  52776 then '5'  when  24557 then '5'  when  23153 then '5'  when  24818 then '5'  when  53729 then '5'  when  53730 then '5'  when  22193 then '5'  when  22321 then '5'
when  26333 then '5'  when  44425 then '5'  when  46989 then '5'  when  53679 then '5'  when  53237 then '5'  when  54560 then '5'  when  22358 then '5'  when  47036 then '5'  when  51835 then '5'  when  22255 then '5'
when  22355 then '5'  when  53593 then '5'  when  46998 then '5'  when  22349 then '5'  when  22345 then '5'  when  44427 then '5'  when  55793 then '5'  when  55794 then '5'
when  55789 then '5'  when  55798 then '5'  when  55788 then '5' when  55790 then '5'  when  55791 then '5'  when  55792 then '5'  when  55795 then '5'  when  55796 then '5'  when  55797 then '5'  when  55799 then '5'
when  55800 then '5'
when   22042    then      '5'            when    22044    then      '5'            when    22235    then      '5'            when    22236    then                '5'            when    22249    then      '5'            when    22252    then      '5'            when    22279    then      '5'            when                22308    then      '5'
when    22311    then      '5'            when    22312    then      '5'            when    22315    then      '5'            when    22319    then                '5'            when    22337    then      '5'            when    22338    then      '5'            when    22340    then      '5'
when    22343    then      '5'            when    22348    then      '5'            when    22356    then      '5'            when    22360    then                '5'            when    22364    then      '5'            when    22366    then      '5'            when    22371    then      '5'
when    22483    then      '5'            when    22664    then      '5'            when    22948    then      '5'            when    23186    then                '5'            when    23468    then      '5'            when    23472    then      '5'            when    24426    then      '5'
when    24427    then      '5'            when    24428    then      '5'            when    24558    then      '5'            when    24603    then                '5'            when    24654    then      '5'            when    24804    then      '5'            when    24822    then      '5'
when    24824    then      '5'            when    25052    then      '5'            when    25081    then      '5'            when    25082    then                '5'            when    25089    then      '5'            when    25136    then      '5'            when    26310    then      '5'
when    26603    then      '5'            when    26989    then      '5'            when    29069    then      '5'            when    30929    then                '5'            when    44426    then      '5'            when    44428    then      '5'            when    44430    then      '5'
when    44431    then      '5'            when    44433    then      '5'            when    44434    then      '5'            when    44435    then                '5'            when    44436    then      '5'            when    44437    then      '5'            when    47003    then      '5'
when    47339    then      '5'            when    47342    then      '5'            when    48282    then      '5'            when    48394    then                '5'            when    48404    then      '5'            when    49842    then      '5'            when    50456    then      '5'
when    50735    then      '5'            when    51831    then      '5'            when    51832    then      '5'            when    52267    then                '5'




-----AEDQ(venu\Mallesh):
when   22585    then      '10'         when    22591    then      '10'         when    22614    then      '10'         when    52737    then                '5'            when    22609    then      '10'         when    22590    then      '10'         when    25639    then      '15'


---Rajkumar team
When 55287 Then  '8.4' When 55584 Then  '8.4' When 50661 Then  '8.4' When 50829 Then  '8.4' When 50654 Then  '8.4' When 50637 Then  '8.4' When 50825 Then  '8.4'
When 50627 Then  '8.4' When 50636 Then  '8.4' When 50862 Then  '8.4' When 50849 Then  '8.4' When 50823 Then  '8.4' When 50822 Then  '8.4' When 50850 Then  '8.4' When 51777 Then  '8.4' When 50813 Then  '8.4' When 50814 Then  '8.4' 
When 50619 Then  '8.4' When 50620 Then  '8.4' When 50623 Then  '8.4' When 50815 Then  '8.4' When 50816 Then  '8.4' When 50821 Then  '8.4' When 50831 Then  '8.4' When 50832 Then  '8.4' When 50835 Then  '8.4' When 50837 Then  '8.4'
When 50838 Then  '8.4' When 50642 Then  '8.4' When 50645 Then  '8.4' When 50820 Then  '8.4' When 50845 Then  '8.4' When 50658 Then  '8.4' When 50660 Then  '8.4' When 50680 Then  '8.4' When 50852 Then  '8.4' When 50854 Then  '8.4' 
When 52204 Then  '8.4' When 50824 Then  '8.4' When 50669 Then  '8.4' When 50812 Then  '8.4' When 50847 Then  '8.4' When 50858 Then  '8.4' When 50860 Then  '8.4' When 50861 Then  '8.4' When 51771 Then  '8.4' When 50843 Then  '8.4'
When 50844 Then  '8.4' When 50842 Then  '8.4' When 51508 Then  '8.4' When 51509 Then  '8.4' When 51511 Then  '8.4'

--Jasprit Team
when    29927   then    (case   SNLANALYSTTASKENTRY when    0   then    40  when    1   then    40  else    40  end)
when    57316   then    (case   SNLANALYSTTASKENTRY when    0   then    40  when    1   then    40  else    40  end)
when    55220   then    (case   SNLANALYSTTASKENTRY when    0   then    40  when    1   then    40  else    40  end)
when    54867   then    (case   SNLANALYSTTASKENTRY when    0   then    90  when    1   then    90  else    40  end)
when    15146   then    (case   SNLANALYSTTASKENTRY when    0   then    32  when    1   then    32  else    32  end)
when    25800   then    (case   SNLANALYSTTASKENTRY when    0   then    5   when    1   then    5   else    5   end)
when    45778   then    (case   SNLANALYSTTASKENTRY when    0   then    5   when    1   then    10  else    2   end)
when    47001   then    (case   SNLANALYSTTASKENTRY when    0   then    6.5 when    1   then    7   else    3   end)
when    57410   then    (case   SNLANALYSTTASKENTRY when    0   then    10  when    1   then    13  else    10  end)
when    52859   then    (case   SNLANALYSTTASKENTRY when    0   then    7   when    1   then    13  else    6   end)
when    52860   then    (case   SNLANALYSTTASKENTRY when    0   then    5   when    1   then    8   else    4   end)
when    52861   then    (case   SNLANALYSTTASKENTRY when    0   then    5   when    1   then    7   else    4   end)
when    52862   then    (case   SNLANALYSTTASKENTRY when    0   then    15  when    1   then    15  else    10  end)
when    52863   then    (case   SNLANALYSTTASKENTRY when    0   then    7   when    1   then    11  else    6   end)
when    52864   then    (case   SNLANALYSTTASKENTRY when    0   then    7   when    1   then    12  else    6   end)
when    52868   then    (case   SNLANALYSTTASKENTRY when    0   then    10  when    1   then    10  else    5   end)
when    52865   then    (case   SNLANALYSTTASKENTRY when    0   then    3   when    1   then    5   else    3   end)
when    52869   then    (case   SNLANALYSTTASKENTRY when    0   then    10  when    1   then    10  else    10  end)
when    52866   then    (case   SNLANALYSTTASKENTRY when    0   then    7   when    1   then    18  else    6   end)
when    52867   then    (case   SNLANALYSTTASKENTRY when    0   then    15  when    1   then    15  else    10  end)
when    54117   then    (case   SNLANALYSTTASKENTRY when    0   then    6   when    1   then    10  else    4   end)
when    54118   then    (case   SNLANALYSTTASKENTRY when    0   then    6   when    1   then    10  else    4   end)
when    54119   then    (case   SNLANALYSTTASKENTRY when    0   then    6   when    1   then    10  else    4   end)
when    50622   then    (case   SNLANALYSTTASKENTRY when    0   then    8   when    1   then    11  else    6   end)
when    50662   then    (case   SNLANALYSTTASKENTRY when    0   then    2   when    1   then    2   else    1   end)
when    50643   then    (case   SNLANALYSTTASKENTRY when    0   then    10  when    1   then    15  else    5   end)
when    50628   then    (case   SNLANALYSTTASKENTRY when    0   then    5   when    1   then    10  else    5   end)
when    50652   then    (case   SNLANALYSTTASKENTRY when    0   then    5   when    1   then    5   else    5   end)
when    50635   then    (case   SNLANALYSTTASKENTRY when    0   then    5   when    1   then    10  else    3   end)
when    50641   then    (case   SNLANALYSTTASKENTRY when    0   then    7   when    1   then    10  else    6   end)
when    50630   then    (case   SNLANALYSTTASKENTRY when    0   then    3   when    1   then    5   else    1   end)
when    50625   then    (case   SNLANALYSTTASKENTRY when    0   then    2   when    1   then    3   else    2   end)
when    50655   then    (case   SNLANALYSTTASKENTRY when    0   then    15  when    1   then    15  else    5   end)
when    50639   then    (case   SNLANALYSTTASKENTRY when    0   then    3   when    1   then    5   else    2   end)
when    50618   then    (case   SNLANALYSTTASKENTRY when    0   then    5   when    1   then    10  else    5   end)
when    50632   then    (case   SNLANALYSTTASKENTRY when    0   then    10  when    1   then    13  else    8   end)
when    50653   then    (case   SNLANALYSTTASKENTRY when    0   then    5   when    1   then    5   else    5   end)
when    50650   then    (case   SNLANALYSTTASKENTRY when    0   then    10  when    1   then    10  else    5   end)
when    50626   then    (case   SNLANALYSTTASKENTRY when    0   then    5   when    1   then    10  else    5   end)
when    50649   then    (case   SNLANALYSTTASKENTRY when    0   then    5   when    1   then    5   else    5   end)
when    50657   then    (case   SNLANALYSTTASKENTRY when    0   then    5   when    1   then    5   else    5   end)
when    50634   then    (case   SNLANALYSTTASKENTRY when    0   then    3   when    1   then    5   else    2   end)
when    50663   then    (case   SNLANALYSTTASKENTRY when    0   then    5   when    1   then    10  else    2   end)
when    50631   then    (case   SNLANALYSTTASKENTRY when    0   then    3   when    1   then    5   else    2   end)
when    50817   then    (case   SNLANALYSTTASKENTRY when    0   then    3   when    1   then    5   else    3   end)
when    50836   then    (case   SNLANALYSTTASKENTRY when    0   then    7   when    1   then    10  else    10  end)
when    50859   then    (case   SNLANALYSTTASKENTRY when    0   then    15  when    1   then    15  else    15  end)
when    50615   then    (case   SNLANALYSTTASKENTRY when    0   then    10  when    1   then    13  else    11  end)
when    50616   then    (case   SNLANALYSTTASKENTRY when    0   then    2   when    1   then    3   else    2   end)
when    50664   then    (case   SNLANALYSTTASKENTRY when    0   then    7   when    1   then    7   else    7   end)
when    50665   then    (case   SNLANALYSTTASKENTRY when    0   then    5   when    1   then    11  else    4   end)
when    50666   then    (case   SNLANALYSTTASKENTRY when    0   then    7   when    1   then    7   else    3   end)
when    50667   then    (case   SNLANALYSTTASKENTRY when    0   then    7   when    1   then    7   else    3   end)
when    50668   then    (case   SNLANALYSTTASKENTRY when    0   then    7   when    1   then    7   else    3   end)
when    50670   then    (case   SNLANALYSTTASKENTRY when    0   then    7   when    1   then    7   else    3   end)
when    50671   then    (case   SNLANALYSTTASKENTRY when    0   then    7   when    1   then    7   else    3   end)
when    50672   then    (case   SNLANALYSTTASKENTRY when    0   then    7   when    1   then    7   else    3   end)
when    50673   then    (case   SNLANALYSTTASKENTRY when    0   then    7   when    1   then    7   else    3   end)
when    50674   then    (case   SNLANALYSTTASKENTRY when    0   then    7   when    1   then    7   else    3   end)
when    50675   then    (case   SNLANALYSTTASKENTRY when    0   then    7   when    1   then    7   else    7   end)
when    50676   then    (case   SNLANALYSTTASKENTRY when    0   then    7   when    1   then    7   else    7   end)
when    50677   then    (case   SNLANALYSTTASKENTRY when    0   then    7   when    1   then    7   else    7   end)
when    50678   then    (case   SNLANALYSTTASKENTRY when    0   then    7   when    1   then    7   else    1   end)
when    50679   then    (case   SNLANALYSTTASKENTRY when    0   then    7   when    1   then    7   else    3   end)
when    50851   then    (case   SNLANALYSTTASKENTRY when    0   then    3   when    1   then    5   else    3   end)
when    50855   then    (case   SNLANALYSTTASKENTRY when    0   then    3   when    1   then    5   else    3   end)
when    50856   then    (case   SNLANALYSTTASKENTRY when    0   then    3   when    1   then    5   else    3   end)
when    55287   then    (case   SNLANALYSTTASKENTRY when    0   then    6   when    1   then    10  else    4   end)
when    50857   then    (case   SNLANALYSTTASKENTRY when    0   then    3   when    1   then    5   else    3   end)
when    50629   then    (case   SNLANALYSTTASKENTRY when    0   then    3   when    1   then    5   else    3   end)
when    50656   then    (case   SNLANALYSTTASKENTRY when    0   then    20  when    1   then    25  else    20  end)
when    50648   then    (case   SNLANALYSTTASKENTRY when    0   then    14  when    1   then    15  else    9   end)
when    50647   then    (case   SNLANALYSTTASKENTRY when    0   then    6   when    1   then    10  else    6   end)
when    50841   then    (case   SNLANALYSTTASKENTRY when    0   then    10  when    1   then    15  else    10  end)
when    50617   then    (case   SNLANALYSTTASKENTRY when    0   then    3   when    1   then    5   else    3   end)
when    50646   then    (case   SNLANALYSTTASKENTRY when    0   then    6   when    1   then    10  else    6   end)
when    50621   then    (case   SNLANALYSTTASKENTRY when    0   then    1   when    1   then    2   else    1   end)
when    50624   then    (case   SNLANALYSTTASKENTRY when    0   then    9   when    1   then    10  else    7   end)
when    50818   then    (case   SNLANALYSTTASKENTRY when    0   then    3   when    1   then    5   else    3   end)
when    50819   then    (case   SNLANALYSTTASKENTRY when    0   then    2   when    1   then    3   else    2   end)
when    50826   then    (case   SNLANALYSTTASKENTRY when    0   then    3   when    1   then    5   else    2   end)
when    50827   then    (case   SNLANALYSTTASKENTRY when    0   then    3   when    1   then    5   else    3   end)
when    50828   then    (case   SNLANALYSTTASKENTRY when    0   then    6   when    1   then    9   else    6   end)
when    50830   then    (case   SNLANALYSTTASKENTRY when    0   then    3   when    1   then    5   else    3   end)
when    50833   then    (case   SNLANALYSTTASKENTRY when    0   then    3   when    1   then    5   else    2   end)
when    50834   then    (case   SNLANALYSTTASKENTRY when    0   then    3   when    1   then    5   else    3   end)
when    50633   then    (case   SNLANALYSTTASKENTRY when    0   then    5   when    1   then    10  else    5   end)
when    50839   then    (case   SNLANALYSTTASKENTRY when    0   then    3   when    1   then    5   else    3   end)
when    50840   then    (case   SNLANALYSTTASKENTRY when    0   then    3   when    1   then    5   else    1   end)
when    50638   then    (case   SNLANALYSTTASKENTRY when    0   then    3   when    1   then    5   else    2   end)
when    50640   then    (case   SNLANALYSTTASKENTRY when    0   then    3   when    1   then    5   else    2   end)
when    50644   then    (case   SNLANALYSTTASKENTRY when    0   then    6   when    1   then    10  else    6   end)
when    52196   then    (case   SNLANALYSTTASKENTRY when    0   then    5   when    1   then    8   else    4   end)
when    50853   then    (case   SNLANALYSTTASKENTRY when    0   then    3   when    1   then    5   else    3   end)
when    50846   then    (case   SNLANALYSTTASKENTRY when    0   then    3   when    1   then    10  else    3   end)
when    50848   then    (case   SNLANALYSTTASKENTRY when    0   then    7   when    1   then    10  else    6   end)
when    50659   then    (case   SNLANALYSTTASKENTRY when    0   then    3   when    1   then    5   else    3   end)
when    50810   then    (case   SNLANALYSTTASKENTRY when    0   then    3   when    1   then    5   else    3   end)
when    54496   then    (case   SNLANALYSTTASKENTRY when    0   then    6   when    1   then    10  else    4   end)
when    54512   then    (case   SNLANALYSTTASKENTRY when    0   then    6   when    1   then    12  else    4   end)
when    54511   then    (case   SNLANALYSTTASKENTRY when    0   then    6   when    1   then    12  else    4   end)
when    54513   then    (case   SNLANALYSTTASKENTRY when    0   then    6   when    1   then    12  else    4   end)
when    54514   then    (case   SNLANALYSTTASKENTRY when    0   then    6   when    1   then    12  else    4   end)
when    54517   then    (case   SNLANALYSTTASKENTRY when    0   then    6   when    1   then    12  else    4   end)
when    54518   then    (case   SNLANALYSTTASKENTRY when    0   then    6   when    1   then    12  else    3   end)
when    54519   then    (case   SNLANALYSTTASKENTRY when    0   then    6   when    1   then    12  else    4   end)
when    54520   then    (case   SNLANALYSTTASKENTRY when    0   then    6   when    1   then    12  else    3   end)
when    54521   then    (case   SNLANALYSTTASKENTRY when    0   then    6   when    1   then    12  else    4   end)
when    54522   then    (case   SNLANALYSTTASKENTRY when    0   then    6   when    1   then    12  else    4   end)
when    54523   then    (case   SNLANALYSTTASKENTRY when    0   then    6   when    1   then    12  else    4   end)
when    54525   then    (case   SNLANALYSTTASKENTRY when    0   then    6   when    1   then    12  else    4   end)
when    54526   then    (case   SNLANALYSTTASKENTRY when    0   then    6   when    1   then    12  else    4   end)
when    54527   then    (case   SNLANALYSTTASKENTRY when    0   then    6   when    1   then    12  else    4   end)
when    51485   then    (case   SNLANALYSTTASKENTRY when    0   then    8   when    1   then    10  else    6   end)
when    51486   then    (case   SNLANALYSTTASKENTRY when    0   then    8   when    1   then    9   else    6   end)
when    51487   then    (case   SNLANALYSTTASKENTRY when    0   then    8   when    1   then    10  else    8   end)
when    51488   then    (case   SNLANALYSTTASKENTRY when    0   then    8   when    1   then    9   else    6   end)
when    51489   then    (case   SNLANALYSTTASKENTRY when    0   then    7   when    1   then    10  else    6   end)
when    51510   then    (case   SNLANALYSTTASKENTRY when    0   then    15  when    1   then    15  else    15  end)
when    51491   then    (case   SNLANALYSTTASKENTRY when    0   then    7   when    1   then    12  else    6   end)
when    51492   then    (case   SNLANALYSTTASKENTRY when    0   then    5   when    1   then    5   else    5   end)
when    51493   then    (case   SNLANALYSTTASKENTRY when    0   then    6   when    1   then    10  else    6   end)
when    51494   then    (case   SNLANALYSTTASKENTRY when    0   then    6   when    1   then    7   else    4   end)
when    51495   then    (case   SNLANALYSTTASKENTRY when    0   then    10  when    1   then    10  else    10  end)
when    51496   then    (case   SNLANALYSTTASKENTRY when    0   then    9   when    1   then    12  else    8   end)
when    51497   then    (case   SNLANALYSTTASKENTRY when    0   then    9   when    1   then    12  else    4   end)
when    51498   then    (case   SNLANALYSTTASKENTRY when    0   then    10  when    1   then    10  else    10  end)
when    51502   then    (case   SNLANALYSTTASKENTRY when    0   then    6   when    1   then    8   else    6   end)
when    51503   then    (case   SNLANALYSTTASKENTRY when    0   then    7   when    1   then    12  else    6   end)
when    51504   then    (case   SNLANALYSTTASKENTRY when    0   then    9   when    1   then    11  else    6   end)
when    51505   then    (case   SNLANALYSTTASKENTRY when    0   then    5   when    1   then    5   else    5   end)
when    51506   then    (case   SNLANALYSTTASKENTRY when    0   then    10  when    1   then    10  else    10  end)
when    51507   then    (case   SNLANALYSTTASKENTRY when    0   then    7   when    1   then    10  else    4   end)
when    51500   then    (case   SNLANALYSTTASKENTRY when    0   then    20  when    1   then    20  else    20  end)
when    51501   then    (case   SNLANALYSTTASKENTRY when    0   then    20  when    1   then    20  else    20  end)
when    51499   then    (case   SNLANALYSTTASKENTRY when    0   then    9   when    1   then    12  else    6   end)
when    51490   then    (case   SNLANALYSTTASKENTRY when    0   then    10  when    1   then    10  else    10  end)
when    51769   then    (case   SNLANALYSTTASKENTRY when    0   then    9   when    1   then    10  else    8   end)
when    51772   then    (case   SNLANALYSTTASKENTRY when    0   then    4   when    1   then    6   else    4   end)
when    51770   then    (case   SNLANALYSTTASKENTRY when    0   then    7   when    1   then    9   else    6   end)
when    51768   then    (case   SNLANALYSTTASKENTRY when    0   then    8   when    1   then    9   else    6   end)
when    51773   then    (case   SNLANALYSTTASKENTRY when    0   then    7   when    1   then    9   else    6   end)
when    51775   then    (case   SNLANALYSTTASKENTRY when    0   then    20  when    1   then    20  else    20  end)
when    51776   then    (case   SNLANALYSTTASKENTRY when    0   then    10  when    1   then    10  else    10  end)
when    49666   then    (case   SNLANALYSTTASKENTRY when    0   then    40  when    1   then    40  else    40  end)


-----Kishore team Expiration
When 22139 Then  '4'     When 22141 Then  '9'     When 22149 Then  '5'     When 22151 Then  '4.4'        When 22152 Then  '3'     When 22153 Then  '4'     When 22156 Then  '2'     When 22157 Then  '5'
When 22158 Then  '3.4' When 22160 Then  '4'     When 22161 Then  '4.5' When 22163 Then  '5'     When 22180 Then  '5'                When 22183 Then  '3'     When 23887 Then  '5'
When 23890 Then  '6'     When 23892 Then  '4'     When 23893 Then  '5'     When 31157 Then  '5'     When 52463 Then  '2'                When 53199 Then  '5'     When 53194 Then  '5'     When 53139 Then  '10'

-----Sundar team EF
When 22278 Then  '5'     When 58287 then '10' When 54387 Then  '5' When 28419 Then  '5' When 29435 Then  '5' When 21850 Then  '5'   When 23900 Then  '5'  
when    21853   then    (case   SNLANALYSTTASKENTRY when    0   then    4   when    1   then    5   else    4   end)
when    21820   then    (case   SNLANALYSTTASKENTRY when    0   then    5   when    1   then    8   else    4   end)
when    28430   then    (case   SNLANALYSTTASKENTRY when    0   then    10  when    1   then    15  else    5   end)
when    52310   then    (case   SNLANALYSTTASKENTRY when    0   then    5   when    1   then    6   else    5   end)
when    25614   then    (case   SNLANALYSTTASKENTRY when    0   then    5   when    1   then    6   else    4   end)
when    21851   then    (case   SNLANALYSTTASKENTRY when    0   then    6   when    1   then    8   else    3   end)
when    22138   then    (case   SNLANALYSTTASKENTRY when    0   then    4   when    1   then    5   else    3   end)
when    23847   then    (case   SNLANALYSTTASKENTRY when    0   then    10  when    1   then    15  else    7   end)
when    23845   then    (case   SNLANALYSTTASKENTRY when    0   then    10  when    1   then    15  else    7   end)
when    58292   then    (case   SNLANALYSTTASKENTRY when    0   then    15  when    1   then    20  else    0   end)
when    58293   then    (case   SNLANALYSTTASKENTRY when    0   then    15  when    1   then    20  else    0   end)
when    58117   then    (case   SNLANALYSTTASKENTRY when    0   then    5   when    1   then    8   else    5   end)



-----Added Task-1 and Task-2 wise weights--------------
--22185, 22169 --task-1 -- 8 --task-2 --5 

--When 22185 Then  '8': Lavanya team Expiration --When 22169 Then  '8.5'
--When 22185 Then  '5': Lavanya team EF --When 22169 Then  '5'
--When 22185 Then  '5': Mallesh DQ team --When 22169 Then  '5'

when 22185 then (case ti.TaskName when 'Task1' then 8 when 'Task2' then 5 end) 
when 22169 then (case ti.TaskName when 'Task1' then 8.5 when 'Task2' then 5 end) 
when 22227 then (case ti.TaskName when 'Task1' then 7.5 when 'Task2' then 5 end) 
when 22286 then (case ti.TaskName when 'Task1' then 7.5 when 'Task2' then 10 end) 
when 22420 then (case ti.TaskName when 'Task1' then 10 when 'Task2' then 9 end) 
when 22422 then (case ti.TaskName when 'Task1' then 10 when 'Task2' then 5 end) 
when 22418 then (case ti.TaskName when 'Task1' then 7.5 when 'Task2' then 12.5 end) 
when 22419 then (case ti.TaskName when 'Task1' then 7.5 when 'Task2' then 5 end) 
when 22150 then (case ti.TaskName when 'Task1' then 3 when 'Task2' then 10 end) 
--when 56644 then (case ti.TaskName when 'Task1' then 0 when 'Task2' then 5 end) 

else '1' end as Jobscount,ipi.processinstancecompleted,ipi.processinstancetargetdate,


case  ips.keyprocessstream  
---when 45587 then (case SNLANALYSTTASKENTRY when 0 then 2 when 1 then 5 else 3 end)
when 21896 then (case SNLANALYSTTASKENTRY when 0 then 5 when 1 then 7 else 3 end) 
when 22219 then (case SNLANALYSTTASKENTRY when 0 then 7 when 1 then 10 else 3 end) 
when 22242 then (case SNLANALYSTTASKENTRY when 0 then 7 when 1 then 10 else 3 end) 
when 22249 then (case SNLANALYSTTASKENTRY when 0 then 8 when 1 then 12 else 4 end) 
when 22283 then (case SNLANALYSTTASKENTRY when 0 then 7 when 1 then 10 else 3 end) 
when 22317 then (case SNLANALYSTTASKENTRY when 0 then 7 when 1 then 10 else 3 end) 
when 22318 then (case SNLANALYSTTASKENTRY when 0 then 7 when 1 then 10 else 3 end) 
when 22368 then (case SNLANALYSTTASKENTRY when 0 then 7 when 1 then 10 else 3 end) 
when 23145 then (case SNLANALYSTTASKENTRY when 0 then 10 when 1 then 13 else 3 end) 
when 25760 then (case SNLANALYSTTASKENTRY when 0 then 17 when 1 then 17 else 8 end) 
when 26702 then (case SNLANALYSTTASKENTRY when 0 then 7 when 1 then 10 else 3 end) 
when 44683 then (case SNLANALYSTTASKENTRY when 0 then 8 when 1 then 8 else 8 end) 
when 47229 then (case SNLANALYSTTASKENTRY when 0 then 10 when 1 then 13 else 3 end) 
when 47277 then (case SNLANALYSTTASKENTRY when 0 then 10 when 1 then 13 else 3 end) 
when 47279 then (case SNLANALYSTTASKENTRY when 0 then 10 when 1 then 13 else 3 end) 
when 47280 then (case SNLANALYSTTASKENTRY when 0 then 10 when 1 then 13 else 3 end) 
when 48669 then (case SNLANALYSTTASKENTRY when 0 then 4 when 1 then 10 else 3 end) 
when 48676 then (case SNLANALYSTTASKENTRY when 0 then 7 when 1 then 10 else 3 end) 
when 48677 then (case SNLANALYSTTASKENTRY when 0 then 7 when 1 then 10 else 3 end) 
when 48681 then (case SNLANALYSTTASKENTRY when 0 then 10 when 1 then 13 else 3 end) 
when 48682 then (case SNLANALYSTTASKENTRY when 0 then 7 when 1 then 10 else 3 end) 
when 48683 then (case SNLANALYSTTASKENTRY when 0 then 7 when 1 then 10 else 3 end) 
when 48684 then (case SNLANALYSTTASKENTRY when 0 then 7 when 1 then 10 else 3 end) 
when 48686 then (case SNLANALYSTTASKENTRY when 0 then 7 when 1 then 10 else 3 end) 
when 48687 then (case SNLANALYSTTASKENTRY when 0 then 7 when 1 then 10 else 3 end) 
when 48688 then (case SNLANALYSTTASKENTRY when 0 then 7 when 1 then 10 else 3 end) 
when 48690 then (case SNLANALYSTTASKENTRY when 0 then 7 when 1 then 10 else 3 end) 
when 48692 then (case SNLANALYSTTASKENTRY when 0 then 7 when 1 then 10 else 3 end) 
when 48693 then (case SNLANALYSTTASKENTRY when 0 then 7 when 1 then 10 else 3 end) 
when 48694 then (case SNLANALYSTTASKENTRY when 0 then 7 when 1 then 10 else 3 end) 
when 48695 then (case SNLANALYSTTASKENTRY when 0 then 7 when 1 then 10 else 3 end) 
when 48696 then (case SNLANALYSTTASKENTRY when 0 then 7 when 1 then 10 else 3 end) 
when 48697 then (case SNLANALYSTTASKENTRY when 0 then 7 when 1 then 10 else 3 end) 
when 49249 then (case SNLANALYSTTASKENTRY when 0 then 10 when 1 then 13 else 3 end) 
when 50529 then (case SNLANALYSTTASKENTRY when 0 then 17 when 1 then 17 else 8 end) 
when 51006 then (case SNLANALYSTTASKENTRY when 0 then 5 when 1 then 7 else 3 end) 
when 51011 then (case SNLANALYSTTASKENTRY when 0 then 10 when 1 then 13 else 3 end) 
when 51012 then (case SNLANALYSTTASKENTRY when 0 then 10 when 1 then 13 else 3 end) 
when 51156 then (case SNLANALYSTTASKENTRY when 0 then 8 when 1 then 8 else 4 end) 
when 51417 then (case SNLANALYSTTASKENTRY when 0 then 7 when 1 then 10 else 3 end) 
when 51909 then (case SNLANALYSTTASKENTRY when 0 then 120 when 1 then 120 else 60 end) 
when 53135 then (case SNLANALYSTTASKENTRY when 0 then 60 when 1 then 60 else 30 end) 
when 53250 then (case SNLANALYSTTASKENTRY when 0 then 7 when 1 then 10 else 3 end) 
when 53449 then (case SNLANALYSTTASKENTRY when 0 then 7 when 1 then 10 else 3 end) 
when 53548 then (case SNLANALYSTTASKENTRY when 0 then 7 when 1 then 10 else 3 end) 
when 53683 then (case SNLANALYSTTASKENTRY when 0 then 58 when 1 then 60 else 10 end) 
when 53687 then (case SNLANALYSTTASKENTRY when 0 then 410 when 1 then 420 else 10 end) 
when 54033 then (case SNLANALYSTTASKENTRY when 0 then 7 when 1 then 10 else 3 end) 
when 22125        then (case SNLANALYSTTASKENTRY when             0              then      24           when    1              then      30                else        7              end) 
when 22126         then (case SNLANALYSTTASKENTRY when             0            then       13           when     1             then       18                 else       10           end) 
when 22127         then (case SNLANALYSTTASKENTRY                        when     0             then       16           when     1             then                 19           else        10           end) 
when 19214        then (case SNLANALYSTTASKENTRY when             0              then      60           when    1              then      60                else        60           end) 
when 19215        then (case SNLANALYSTTASKENTRY when             0              then      60           when    1              then      60                else        60           end) 
when 21963        then (case SNLANALYSTTASKENTRY when             0              then      26           when    1              then      30                else        26           end) 
when 21965        then (case SNLANALYSTTASKENTRY         when    0              then      6              when    1              then      6                else        6              end) 
when 21972         then (case SNLANALYSTTASKENTRY when 0 then 20 when 1 then 20 else 20 end) 
when 21973         then (case SNLANALYSTTASKENTRY when 0 then 20 when 1 then 20 else 20 end) 
when 22110         then (case SNLANALYSTTASKENTRY when 0 then 30 when 1 then 30 else 30 end) 
when 22116         then (case SNLANALYSTTASKENTRY when 0 then 140 when 1 then 140 else 140 end) 
when 22117         then (case SNLANALYSTTASKENTRY when 0 then 6 when 1 then 8 else 6 end) 
when 22122         then (case SNLANALYSTTASKENTRY when 0 then 30 when 1 then 35 else 30 end) 
when 22123         then (case SNLANALYSTTASKENTRY when 0 then 5 when 1 then 8 else 5 end) 
when 22579         then (case SNLANALYSTTASKENTRY when 0 then 20 when 1 then 20 else 20 end) 
when 22589         then (case SNLANALYSTTASKENTRY when 0 then 30 when 1 then 30 else 30 end) 
when 22595         then (case SNLANALYSTTASKENTRY when 0 then 30 when 1 then 30 else 30 end) 
when 22599         then (case SNLANALYSTTASKENTRY when 0 then 30 when 1 then 30 else 30 end) 
when 23439         then (case SNLANALYSTTASKENTRY when 0 then 15 when 1 then 20 else 15 end) 
when 23849         then (case SNLANALYSTTASKENTRY when 0 then 15 when 1 then 20 else 15 end) 
when 25035         then (case SNLANALYSTTASKENTRY when 0 then 30 when 1 then 30 else 30 end) 
when 28632         then (case SNLANALYSTTASKENTRY when 0 then 20 when 1 then 20 else 20 end) 
when 28633         then (case SNLANALYSTTASKENTRY when 0 then 20 when 1 then 20 else 20 end) 
when 30896         then (case SNLANALYSTTASKENTRY when 0 then 10 when 1 then 20 else 10 end) 
when 31357         then (case SNLANALYSTTASKENTRY when 0 then 5 when 1 then 8 else 5 end) 
when 53140         then (case SNLANALYSTTASKENTRY when 0 then 60 when 1 then 60 else 60 end) 
when 53447         then (case SNLANALYSTTASKENTRY when 0 then 15 when 1 then 30 else 15 end) 
when 26522        then (case SNLANALYSTTASKENTRY when 0 then 7 when 1 then 14 else 7 end) 
when 22017        then (case SNLANALYSTTASKENTRY when 0 then 3 when 1 then 5 else 3 end) 
when 56612        then (case SNLANALYSTTASKENTRY when 0 then 3 when 1 then 5 else 3 end) 
when 56620        then (case SNLANALYSTTASKENTRY when 0 then 2 when 1 then 3 else 2 end) 
when 56668        then (case SNLANALYSTTASKENTRY when 0 then 10 when 1 then 15 else 5 end)


----(Need to change weights based on average)


------Missing actual team
when    22365    then  (case SNLANALYSTTASKENTRY when 0 then 7.56 when 1 then 7.56 else 7.56 end)
when    22367    then  (case SNLANALYSTTASKENTRY when 0 then 8.4 when 1 then 8.4 else 8.4 end)
when    23351    then  (case SNLANALYSTTASKENTRY when 0 then 6.72 when 1 then 10.08 else 3.36 end)
when    24474    then  (case SNLANALYSTTASKENTRY when 0 then 10.08 when 1 then 12.6 else 3.36 end)
when    25314    then  (case SNLANALYSTTASKENTRY when 0 then 16.8 when 1 then 16.8 else 8.4 end)
when    25582    then  (case SNLANALYSTTASKENTRY when 0 then 10.08 when 1 then 12.6 else 3.36 end)
when    25724    then  (case SNLANALYSTTASKENTRY when 0 then 8.4 when 1 then 16.8 else 3.36 end)
when    31124    then  (case SNLANALYSTTASKENTRY when 0 then 6.72 when 1 then 10.08 else 3.36 end)
when    48698    then  (case SNLANALYSTTASKENTRY when 0 then 6.72 when 1 then 10.08 else 3.36 end)
when    50749    then  (case SNLANALYSTTASKENTRY when 0 then 20 when 1 then 20 else 20 end)

--Siva Ranjani Team
when    57116    then  (case SNLANALYSTTASKENTRY when 0 then 4 when 1 then 8 else 2.5 end)
when    57778    then  (case SNLANALYSTTASKENTRY when 0 then 4 when 1 then 5 else 3 end)
when    57779    then  (case SNLANALYSTTASKENTRY when 0 then 3 when 1 then 4 else 2 end)
when    57780    then  (case SNLANALYSTTASKENTRY when 0 then 7 when 1 then 10 else 5 end)
when    58092    then  (case SNLANALYSTTASKENTRY when 0 then 4 when 1 then 5 else 3 end)
when    58130    then  (case SNLANALYSTTASKENTRY when 0 then 5 when 1 then 7 else 4 end)
when    56911    then  (case SNLANALYSTTASKENTRY when 0 then 12 when 1 then 15 else 3 end)
when    57782    then  (case SNLANALYSTTASKENTRY when 0 then 8 when 1 then 10 else 3 end)
when    57811    then  (case SNLANALYSTTASKENTRY when 0 then 8 when 1 then 10 else 3 end)
when    57826    then  (case SNLANALYSTTASKENTRY when 0 then 8 when 1 then 10 else 3 end)
when    58280    then  (case SNLANALYSTTASKENTRY when 0 then 8 when 1 then 10 else 3 end)
when    57783    then  (case SNLANALYSTTASKENTRY when 0 then 4 when 1 then 5 else 3 end)


--when 45587 then (case SNLANALYSTTASKENTRY when 0 then 2 when 1 then 5 else 3 end)
--when 45587 then (case SNLANALYSTTASKENTRY when 0 then 2 when 1 then 5 else 3 end)
end [Task_Update_Weights]

INTO #RRR from ProcessInstance ipi
inner join ProcessStream ips on ipi.KeyProcessStream = ips.KeyProcessStream and ips.UpdOperation < 2
join TaskInstance ti on ipi.KeyProcessInstance = ti.KeyProcessInstance and  ti.UpdOperation < 2
Left join internaluseonly.dbo.Employee p on ti.KeyPerson = p.KeyPerson
LEFT JOIN #KEYPEIN P1 ON TI.KEYPERSON = P1.KEYPERSON
--left join ProcessStreamGroup psg on psg.KeyProcessStream=ipi.KeyProcessStream
where ipi.updoperation < 2
and ti.TaskInstanceCompleted + '05:30' >='2023-12-01 06:00:00.000' --'05/01/2022'
and ti.TaskInstanceCompleted + '05:30' <='2023-12-31 05:59:59.999' --'06/01/2022'
and ips.KeyDepartment=143
--and psg.KeyProcessGroup in (622,996)
----and p.keyperson in (750728,751232,752018,750765,751938,751506,750924,750656,752564,750909,752113,750404,752562,751017,750725,750763,752020,750935,750544,750694,749787,750905,776213,1041729,1183251)
and ips.keyprocessstream in (57116,56911,57410,57782,57811,57826,46731,30896,22595,48681,51011,51012,51417,53548,54033,53449,53250,22219,48695,48669,22317,48686,26702,48687,22368,48683,48696,48684,48697,22242,22318,48692,48694,48688,48693,48690,22283,48682,48676,22249,48677,47229,47280,47277,25760,23145,47279,21896,51006,50529,49249,44683,51156,52859,52860,52861,52862,52863,52864,52868,52865,52869,52866,52867,54117,54118,54119,50622,50662,50643,50628,50652,50635,50641,50630,50625,50655,50639,50618,50632,50653,50650,50626,50649,50657,50634,50663,50631,50817,50836,50859,50615,50616,50664,50665,50666,50667,50668,50670,50671,50672,50673,50674,50675,50676,50677,50678,50679,50851,50855,50856,50857,50629,50656,50648,50647,50841,50617,50646,50621,50624,50818,50819,50826,50827,50828,50830,50833,50834,50633,50839,50840,50638,50640,50644,52196,50853,50846,50848,50659,50810,54496,54512,54511,54513,54514,54517,54518,54519,54520,54521,54522,54523,54525,54526,54527,51485,51486,51487,51488,51489,51510,51491,51492,51493,51494,51495,51496,51497,51498,51502,51503,51504,51505,51506,51507,51500,51501,51499,51490,51769,51772,51770,51768,51773,51775,51776,55287,55584,50661,50829,50654,50637,50825,50627,50636,50862,50849,50823,50822,50850,51777,50813,50814,50619,50620,50623,50815,50816,50821,50831,50832,50835,50837,50838,50642,50645,50820,50845,50658,50660,50680,50852,50854,52204,50824,50669,50812,50847,50858,50860,50861,51771,50843,50844,50842,51508,51509,51511,22125,22126,22127,49666,19214,19215,21963,21965,21972,21973,22110,22116,22117,22122,22123,22579,22589,22595,22599,23439,23849,25035,28632,28633,30896,31357,53140,53447,26522,52862,52863,52864,52868,52865,52869,52866,52867,54117,54118,54119,50622,50662,50643,50628,50652,50635,50641,50630,50625,50655,50639,50618,50632,50653,50650,50626,50649,50657,50634,50663,50631,50817,50836,50859,50615,50616,50664,50665,50666,50667,50668,50670,50671,50672,50673,50674,50675,50676,50677,50678,50679,50851,50855,50856,50857,50629,50656,50648,50647,50841,50617,50646,50621,50624,50818,50819,50826,50827,50828,50830,50833,50834,50633,50839,50840,50638,50640,50644,52196,50853,50846,50848,50659,50810,54496,54512,54511,54513,54514,54517,54518,54519,54520,54521,54522,54523,54525,54526,54527,51485,51486,51487,51488,51489,51510,51491,51492,51493,51494,51495,51496,51497,51498,51502,51503,51504,51505,51506,51507,51500,51501,51499,51490,51769,51772,51770,51768,51773,51775,51776,55287,55584,50661,50829,50654,50637,50825,50627,50636,50862,50849,50823,50822,50850,51777,50813,50814,50619,50620,50623,50815,50816,50821,50831,50832,50835,50837,50838,50642,50645,50820,50845,50658,50660,50680,50852,50854,52204,50824,50669,50812,50847,50858,50860,50861,51771,50843,50844,50842,51508,51509,51511,22125,22126,22127,19214,19215,21963,21965,21972,21973,22110,22116,22117,22122,22123,22579,22589,22595,22599,23439,23849,25035,28632,28633,30896,31357,53140,53447,45587,47106,25873,22309,22188,22288,22020,22227,46731,22422,47029,22351,22336,22237,22244,22020,22020,22182,22190,55278,22099,31283,23467,47001,25800,22286,22020,22289,22424,22050,44429,47133,22098,22089,22020,22020,23911,22216,45588,22284,45778,45585,44423,22020,22020,23911,22420,22287,23146,22240,22290,22427,22020,22020,22281,26085,22323,22425,44422,25757,22307,22020,22419,22280,47323,47000,22301,22192,22020,22418,47347,51907,22333,49174,22357,22350,53127,22359,22342,23247,53175,24605,53174,53173,53595,22320,47032,44421,44432,53593,22339,50874,22193,53730,22278,22236,53729,44425,22255,22358,22356,27228,22363,53169,46989,53237,22215,22361,51835,22094,22245,22321,25801,47044,47031,22304,24557,48131,47017,22355,22353,44427,27171,22139,22141,22149,22150,22151,22152,22153,22156,22157,22158,22160,22161,22163,22169,22180,22183,22185,23887,23890,23892,23893,31157,52463,53199,53194,53139,21853,22138,22169,22185,22227,22278,22286,22418,22419,22420,23845,23847,28430,54387,28419,29435,21850,25614,21851,23900,21820,22422,45587,47106,25873,22309,22188,22288,22020,22227,46731,22422,47029,22351,22336,22237,22244,22020,22020,22182,22190,55278,22099,31283,23467,22286,22020,22289,22424,22050,44429,47133,22098,22089,22020,22020,23911,22216,45588,22284,45585,44423,22020,22020,23911,22420,22287,22240,22290,22427,22020,22020,22281,26085,22323,22425,44422,25757,22307,22020,22419,22280,47323,47000,22301,22192,22020,22418,47347,51907,49174,21898,53175,25801,22342,53169,53174,22304,27228,53173,48131,27171,22357,53127,47031,22350,22333,22359,22320,22361,22091,24605,47105,53170,47032,47044,22222,47027,23247,22335,44432,22215,22278,47017,44421,22363,22353,50874,22245,22094,53595,22339,53597,52776,24557,23153,24818,53729,53730,22193,22321,26333,44425,46989,53679,53237,54560,22358,47036,51835,22255,22355,53593,46998,22185,22169,22349,22345,44427,55793,55794,55789,55798,55788,55790,55791,55792,55795,55796,55797,55799,55800,22365,22367,23351,24474,25314,25582,25724,31124,48698,22017,22356,22585,22591,22614,52737,22609,22590,25639,22042,22044,22235,22236,22249,22252,22279,22308,22311,22312,22315,22319,22337,22338,22340,22343,22348,22356,22360,22364,22366,22371,22483,22664,22948,23186,23468,23472,24426,24427,24428,24558,24603,24654,24804,24822,24824,25052,25081,25082,25089,25136,26310,26603,26989,29069,30929,44426,44428,44430,44431,44433,44434,44435,44436,44437,47003,47339,47342,48282,48394,48404,49842,50456,50735,51831,51832,52267,56612,56620,56668,58287,58292,58293,58117,29927, 57316, 15146, 54867,50749,57778, 57779, 57780, 58092, 58130, 58280, 57783,52310)
-- Special work KPSs 53455 53475 53437
--and p.SPGMIEIN=810825710
--select * from #rrr where SPGMIEIN=810823494 and keyprocessstream=45587 and SNLANALYSTTASKENTRY=1
--select * from #RRR

if OBJECT_ID('tempdb..#count_updated_cases') is not null drop table #count_updated_cases
select EndDate,keyperson,isnull(count(SNLANALYSTTASKENTRY),0) count_updated_cases into #count_updated_cases  from #rrr 
 where SNLANALYSTTASKENTRY=1 group by EndDate,keyperson

if object_id('tempdb..#Goal_reached_jobs') is not null drop table #Goal_reached_jobs
select distinct enddate,keyperson,isnull(count(processinstanceappianid),0) Goal_reached_jobs into #Goal_reached_jobs from #rrr
where TaskInstanceEffort<=ExpectedTaskEffort
group by enddate,keyperson
--select * from #Goal_reached_jobs where SPGMIEIN=710830545

if object_id('tempdb..#e') is not null drop table #e
select DISTINCT  r.Enddate,r.keyperson,r.SPGMIEIN,
--case r.SPGMIEIN when 710822994 then '108017'when 710817060 then 'B06007'when 710815382 then '706079'when 710817401 then 'C06011'when 710819909 then '507081'when 710819845 then '507017'when 710820964 then '707022'when 710830543 then '110021'when 710834869 then '311002'when 710813736 then '406025'when 710818250 then '207007'when 710819885 then '611082'when 710822994 then '108017'when 710825998 then '708061'when 710830050 then 'B09015'when 710834871 then '311004'when 710818252 then '207009'when 710830545 then '110023'when 710805175 then '904008'
--when 710805175 then '904008' when 810828588 then '000995' when 810830718 then '001229' 
--end as empid, 
--case r.SPGMIEIN when 710817060 then 'Shaik Noorjahan'when 710817401 then 'Nagaraju Peddakotla'when 710815382 then 'Sahu  Santosh Kumar'when 710819909 then 'Raghavapurapu  Venkata Nageswara Rao'when 710819845 then 'Ram Babu Surla'when 710820964 then 'Pogula Srinivasa Rao'when 710830543 then 'Veeranjaneyulu Vaddineedi'when 710834869 then 'Mahaboob Basha Shaik'when 710813736 then 'Kakarparty Sita Devi'when 710818250 then 'Parasa Vinay Kumar'when 710819885 then 'Muni Vasu Deva Reddy Kuppireddy'when 710822994 then 'Chaudarapu Vishwanath'when 710825998 then 'Janardhana Aligi'when 710830050 then 'Chitra Hari Krishna'when 710834871 then 'Ravi Kumar Ponaganti'when 710818252 then 'Prabhakar Reddy Ragula'when 710830545 then 'Poornima Dara'when 710805175 then 'Musunuru Lakshmi Soujanya'
--when 810828588 then 'Priyanka Tulsani' when 810830718 then 'Roshni Panchal'
--end as EmpName,
r.Loginname,count(processinstanceappianid) Actual_Total_Jobs_Count,sum(CAST(JOBSCOUNT AS decimal(18,2))) After_Weight_Jobs,count_updated_cases,isnull(TaskInstanceEffort,0) as TaskInstanceEfforts,--sum(CAST(Task_Update_weights AS decimal(18,2))) After_Weight_Jobs1,
isnull(Goal_reached_jobs,0) Goal_reached_jobs into #e from #RRR r 
--sum(taskinstanceeffort) Actual_Effort,sum(Expectedtaskeffort) Estimated_Effort,
inner join internaluseonly.dbo.Employee p on  p.KeyPerson=r.KeyPerson
left join #count_updated_cases c on c.keyperson=r.keyperson and c.Enddate=r.Enddate
left join #Goal_reached_jobs d on d.keyperson=r.keyperson and d.Enddate=r.Enddate
--below astream are related to 0,1,2---
where KeyProcessStream not in (57116,56911,57782,57811,57826,21896,22219,22242,22249,22283,22317,22318,22368,23145,25760,26702,44683,47229,47277,47279,47280,48669,48676,48677,48681,48682,48683,48684,48686,48687,48688,48690,48692,48693,48694,48695,48696,48697,49249,50529,51006,51011,51012,51156,51417,51909,53135,53250,53449,53548,53683,53687,54033,22125,22126,22127,19214,19215,21963,21965,21972,21973,22110,22116,22117,22122,22123,22579,22589,22595,22599,23439,23849,25035,28632,28633,30896,31357,53140,53447,26522,22365,22367,23351,24474,25314,25582,25724,31124,48698,22017,56612,56620,56668,50749,57778, 57779, 57780, 58092, 58130, 58280, 57783)
GROUP BY r.Loginname,r.keyperson,r.SPGMIEIN,r.ENDDATE,count_updated_cases,Goal_reached_jobs,TaskInstanceEffort --ORDER BY r.Enddate
--select * from #e where SPGMIEIN=710813738



UNION ALL
select DISTINCT  r.Enddate,r.keyperson,r.SPGMIEIN,
--case r.SPGMIEIN when 710822994 then '108017'when 710817060 then 'B06007'when 710815382 then '706079'when 710817401 then 'C06011'when 710819909 then '507081'when 710819845 then '507017'when 710820964 then '707022'when 710830543 then '110021'when 710834869 then '311002'when 710813736 then '406025'when 710818250 then '207007'when 710819885 then '611082'when 710822994 then '108017'when 710825998 then '708061'when 710830050 then 'B09015'when 710834871 then '311004'when 710818252 then '207009'when 710830545 then '110023'when 710805175 then '904008'
--when 710805175 then '904008' when 810828588 then '000995' when 810830718 then '001229' 
--end as empid, 
--case r.SPGMIEIN when 710817060 then 'Shaik Noorjahan'when 710817401 then 'Nagaraju Peddakotla'when 710815382 then 'Sahu  Santosh Kumar'when 710819909 then 'Raghavapurapu  Venkata Nageswara Rao'when 710819845 then 'Ram Babu Surla'when 710820964 then 'Pogula Srinivasa Rao'when 710830543 then 'Veeranjaneyulu Vaddineedi'when 710834869 then 'Mahaboob Basha Shaik'when 710813736 then 'Kakarparty Sita Devi'when 710818250 then 'Parasa Vinay Kumar'when 710819885 then 'Muni Vasu Deva Reddy Kuppireddy'when 710822994 then 'Chaudarapu Vishwanath'when 710825998 then 'Janardhana Aligi'when 710830050 then 'Chitra Hari Krishna'when 710834871 then 'Ravi Kumar Ponaganti'when 710818252 then 'Prabhakar Reddy Ragula'when 710830545 then 'Poornima Dara'when 710805175 then 'Musunuru Lakshmi Soujanya'
--when 810828588 then 'Priyanka Tulsani' when 810830718 then 'Roshni Panchal'
--end as EmpName,
r.Loginname,count(processinstanceappianid) Actual_Total_Jobs_Count,sum(CAST(Task_Update_weights AS decimal(18,2))) After_Weight_Jobs,count_updated_cases,--sum(CAST(Task_Update_weights AS decimal(18,2))) After_Weight_Jobs1,
isnull(Goal_reached_jobs,0) Goal_reached_jobs,isnull(TaskInstanceEffort,0) as TaskInstanceEfforts from #RRR r 
--sum(taskinstanceeffort) Actual_Effort,sum(Expectedtaskeffort) Estimated_Effort,
inner join internaluseonly.dbo.Employee p on  p.keyperson=r.keyperson
left join #count_updated_cases c on c.keyperson=r.keyperson and c.Enddate=r.Enddate
left join #Goal_reached_jobs d on d.keyperson=r.keyperson and d.Enddate=r.Enddate
where KeyProcessStream in (57116,56911,57782,57811,57826,21896,22219,22242,22249,22283,22317,22318,22368,23145,25760,26702,44683,47229,47277,47279,47280,48669,48676,48677,48681,48682,48683,48684,48686,48687,48688,48690,48692,48693,48694,48695,48696,48697,49249,50529,51006,51011,51012,51156,51417,51909,53135,53250,53449,53548,53683,53687,54033,22125,22126,22127,19214,19215,21963,21965,21972,21973,22110,22116,22117,22122,22123,22579,22589,22595,22599,23439,23849,25035,28632,28633,30896,31357,53140,53447,26522,22365,22367,23351,24474,25314,25582,25724,31124,48698,22017,56612,56620,56668,50749,57778, 57779, 57780, 58092, 58130, 58280, 57783)
GROUP BY r.Loginname,r.keyperson,r.SPGMIEIN,r.ENDDATE,count_updated_cases,Goal_reached_jobs,TaskInstanceEffort --ORDER BY r.Enddate
--select * from #e where SPGMIEIN=710830545

--select * from #e
select distinct keyperson,SPGMIEIN,Loginname,sum(Actual_Total_Jobs_Count) Actual_Total_Jobs_Count,sum(After_Weight_Jobs) After_Weight_Jobs,
sum(count_updated_cases) count_updated_cases,sum(Goal_reached_jobs) Goal_reached_jobs,sum(TaskInstanceEfforts) as TimetakenforJobs from #e
--where SPGMIEIN=710813742
---Where keyperson in (751294,751511,751298,750615,750794,751291,750670,751234,750871,750826)
group by keyperson,SPGMIEIN,Loginname




--select * from #RRR Where keyperson in (751298,751291,751234,750871,750826) ORDER BY Enddate

select * from #RRR ---Where keyperson in (751298,751291,751234,750871,750826) ORDER BY Enddate

--select * from #e Where keyperson in (751298) ORDER BY Enddate